GCC = arm-elf-gcc -nostdlib
GCCFLAGS = -mcpu=arm7tdmi
LD = arm-elf-ld
LDFLAGS = 
OBJCOPY = arm-elf-objcopy

all: loader
#hook demo

loader: loader.s
	@rm -rf loader.bin
	$(GCC) $(GCCFLAGS) -o loader.o loader.S
	$(LD) $(LDFLAGS) -Ttext 0x00000000 -o loader.elf loader.o
	$(OBJCOPY) -O binary loader.elf loader.bin
	rm -f loader.o loader.elf
	
#hook:
#	@rm -rf hook.bin
#	$(AS) $(ASFLAGS) -o hook.o hook.s
#	$(LD) $(LDFLAGS) -o hook.elf hook.o
#	$(OBJCOPY) -O binary hook.elf hook.bin
#	rm -f hook.o hook.elf
#	cp -f hook.bin hook.tns

#demo:
#	@rm -rf demo.bin
#	$(AS) $(ASFLAGS) -o demo.o demo.s
#	$(LD) $(LDFLAGS) -o demo.elf demo.o
#	$(OBJCOPY) -O binary demo.elf demo.bin
#	rm -f demo.o demo.elf
#	cp -f demo.bin demo.tns

.PHONY: cleanall

cleanall: clean

clean:
	@rm -rf loader.bin
#	@rm -rf hook.bin
#	@rm -rf demo.bin
