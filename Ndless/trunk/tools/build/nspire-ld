#!/bin/sh

cygwin=false
case "`uname`" in
  CYGWIN* )
    cygwin=true
    ;; 
esac

DIRNAME=`dirname "$0"`
# DIRNAME may not be in the toolchain directory if this script was symlinked.
# try to find the symlink target
if which readlink &> /dev/null; then
    DIRNAME=`readlink -n "$0" | xargs dirname`
fi

if $cygwin; then
	DIRNAME=`cygpath --path --windows "$DIRNAME"`
fi

nostdlib=false
for arg in "$@" args; do
	if [ $arg = -nostdlib ] ; then
		nostdlib=true
	fi
done
if [ $nostdlib = false ] ; then
	set "$@" "$DIRNAME/../system/crt0.o" "$DIRNAME/../system/syscalls.o"
fi
# some newlib symbols are not found if ld is used...
arm-elf-gcc -T "$DIRNAME/../system/ldscript" "$@"
